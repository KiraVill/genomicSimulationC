<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>genomicSimulationC: Breeding Value and Allele Count Calculators</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">genomicSimulationC
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Breeding Value and Allele Count Calculators</div>  </div>
</div><!--header-->
<div class="contents">

<p>For calculations related to the loaded allele effects and internal additive breeding value model.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae34db60faf62b898d0572ea6c039b96a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#gae34db60faf62b898d0572ea6c039b96a">split_by_bv</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, int group, int top_n, int lowIsBest)</td></tr>
<tr class="memdesc:gae34db60faf62b898d0572ea6c039b96a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes the <code>top_n</code> individuals in the group with the best breeding values/fitnesses and puts them in a new group.  <a href="group__calculators.html#gae34db60faf62b898d0572ea6c039b96a">More...</a><br /></td></tr>
<tr class="separator:gae34db60faf62b898d0572ea6c039b96a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f80905718ac87e9da1c30a2cec77ea6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga7f80905718ac87e9da1c30a2cec77ea6">calculate_group_bvs</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, unsigned int group)</td></tr>
<tr class="memdesc:ga7f80905718ac87e9da1c30a2cec77ea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the fitness metric/breeding value for each genotype in the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> in a certain group, and returns the results in a <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a>.  <a href="group__calculators.html#ga7f80905718ac87e9da1c30a2cec77ea6">More...</a><br /></td></tr>
<tr class="separator:ga7f80905718ac87e9da1c30a2cec77ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5b177cf40a7e28276c460d60a3ecbb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#gab5b177cf40a7e28276c460d60a3ecbb5">calculate_bvs</a> (<a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *m, <a class="el" href="struct_effect_matrix.html">EffectMatrix</a> *e)</td></tr>
<tr class="memdesc:gab5b177cf40a7e28276c460d60a3ecbb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the fitness metric/breeding value for each genotype in the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a>, and returns the results in a <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> struct.  <a href="group__calculators.html#gab5b177cf40a7e28276c460d60a3ecbb5">More...</a><br /></td></tr>
<tr class="separator:gab5b177cf40a7e28276c460d60a3ecbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad86ea5492e6c1cf918d6449a9eb530de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#gad86ea5492e6c1cf918d6449a9eb530de">calculate_group_count_matrix_of_allele</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, unsigned int group, char allele, <a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *counts)</td></tr>
<tr class="memdesc:gad86ea5492e6c1cf918d6449a9eb530de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of times at each marker that a particular allele appears for each genotype in a group.  <a href="group__calculators.html#gad86ea5492e6c1cf918d6449a9eb530de">More...</a><br /></td></tr>
<tr class="separator:gad86ea5492e6c1cf918d6449a9eb530de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b2b686b9dde986b549f15d72fa4c919"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga0b2b686b9dde986b549f15d72fa4c919">calculate_group_doublecount_matrix_of_allele</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, unsigned int group, char allele, <a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *counts, char allele2, <a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *counts2)</td></tr>
<tr class="memdesc:ga0b2b686b9dde986b549f15d72fa4c919"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of times at each marker that two particular alleles appear for each genotype in a group.  <a href="group__calculators.html#ga0b2b686b9dde986b549f15d72fa4c919">More...</a><br /></td></tr>
<tr class="separator:ga0b2b686b9dde986b549f15d72fa4c919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32b287af2e2955edd565eedf3043f02c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga32b287af2e2955edd565eedf3043f02c">calculate_count_matrix_of_allele</a> (<a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *m, char allele, <a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *counts)</td></tr>
<tr class="memdesc:ga32b287af2e2955edd565eedf3043f02c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of times at each marker that a particular allele appears for each genotype in a particular <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> (does not go through the linked list).  <a href="group__calculators.html#ga32b287af2e2955edd565eedf3043f02c">More...</a><br /></td></tr>
<tr class="separator:ga32b287af2e2955edd565eedf3043f02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e812683e26615b797eb4cd98b694d52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga3e812683e26615b797eb4cd98b694d52">calculate_doublecount_matrix_of_allele</a> (<a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *m, char allele, <a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *counts, char allele2, <a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *counts2)</td></tr>
<tr class="memdesc:ga3e812683e26615b797eb4cd98b694d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of times at each marker that two particular alleles appear for each genotype in an <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> (does not go through the linked list).  <a href="group__calculators.html#ga3e812683e26615b797eb4cd98b694d52">More...</a><br /></td></tr>
<tr class="separator:ga3e812683e26615b797eb4cd98b694d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42f2398ccb53ffafce9b4a17e3222636"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga42f2398ccb53ffafce9b4a17e3222636">calculate_full_count_matrix_of_allele</a> (<a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *m, char allele)</td></tr>
<tr class="memdesc:ga42f2398ccb53ffafce9b4a17e3222636"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of times at each marker that a particular allele appears for each genotype in the linked list starting at the given <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a>.  <a href="group__calculators.html#ga42f2398ccb53ffafce9b4a17e3222636">More...</a><br /></td></tr>
<tr class="separator:ga42f2398ccb53ffafce9b4a17e3222636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f61debfc95036e86953f6111236026f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_marker_blocks.html">MarkerBlocks</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga2f61debfc95036e86953f6111236026f">create_n_blocks_by_chr</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, int n)</td></tr>
<tr class="memdesc:ga2f61debfc95036e86953f6111236026f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Divide the genotype into blocks where each block contains all markers within a 1/n length section of each chromosome in the map, and return the resulting blocks in a struct.  <a href="group__calculators.html#ga2f61debfc95036e86953f6111236026f">More...</a><br /></td></tr>
<tr class="separator:ga2f61debfc95036e86953f6111236026f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga463082fc380a6815f07bd06401927bc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_marker_blocks.html">MarkerBlocks</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga463082fc380a6815f07bd06401927bc0">read_block_file</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, const char *block_file)</td></tr>
<tr class="memdesc:ga463082fc380a6815f07bd06401927bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a file containing definitions of blocks of markers, process that file and return a struct containing the definitions of those blocks.  <a href="group__calculators.html#ga463082fc380a6815f07bd06401927bc0">More...</a><br /></td></tr>
<tr class="separator:ga463082fc380a6815f07bd06401927bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8fdd3011c2ce5228c8c8d6486533369b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga8fdd3011c2ce5228c8c8d6486533369b">calculate_group_local_bvs</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, <a class="el" href="struct_marker_blocks.html">MarkerBlocks</a> b, const char *output_file, int group)</td></tr>
<tr class="memdesc:ga8fdd3011c2ce5228c8c8d6486533369b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a set of blocks of markers in a file, for each genotype in a group, calculate the local fitness metric/breeding value for the first allele at each marker in the block, and the local fitness metric/breeding value for the second allele at each marker in the block, then save the result to a file.  <a href="group__calculators.html#ga8fdd3011c2ce5228c8c8d6486533369b">More...</a><br /></td></tr>
<tr class="separator:ga8fdd3011c2ce5228c8c8d6486533369b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c6e2c2f4447accd4a30031256c1610a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga7c6e2c2f4447accd4a30031256c1610a">calculate_local_bvs</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d, <a class="el" href="struct_marker_blocks.html">MarkerBlocks</a> b, const char *output_file)</td></tr>
<tr class="memdesc:ga7c6e2c2f4447accd4a30031256c1610a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a set of blocks of markers in a file, for each genotype saved, calculate the local BV for the first allele at each marker in the block, and the local BV for the second allele at each marker in the block, then save the result to a file.  <a href="group__calculators.html#ga7c6e2c2f4447accd4a30031256c1610a">More...</a><br /></td></tr>
<tr class="separator:ga7c6e2c2f4447accd4a30031256c1610a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf9a424cc9474272059ff328bfadf755"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#gadf9a424cc9474272059ff328bfadf755">calculate_optimal_alleles</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d)</td></tr>
<tr class="memdesc:gadf9a424cc9474272059ff328bfadf755"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a look at the currently-loaded effect values and creates a string containing the allele with the highest effect value for each marker as ordered in the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a>.  <a href="group__calculators.html#gadf9a424cc9474272059ff328bfadf755">More...</a><br /></td></tr>
<tr class="separator:gadf9a424cc9474272059ff328bfadf755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67d98ae97e5352f32380c8b89b1e4047"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#ga67d98ae97e5352f32380c8b89b1e4047">calculate_optimum_bv</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d)</td></tr>
<tr class="memdesc:ga67d98ae97e5352f32380c8b89b1e4047"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a look at the currently-loaded effect values and returns the highest possible breeding value any (diploid) genotype could have using those effect values.  <a href="group__calculators.html#ga67d98ae97e5352f32380c8b89b1e4047">More...</a><br /></td></tr>
<tr class="separator:ga67d98ae97e5352f32380c8b89b1e4047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacef164c7781f3aa15928b482c3845418"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__calculators.html#gacef164c7781f3aa15928b482c3845418">calculate_minimum_bv</a> (<a class="el" href="struct_sim_data.html">SimData</a> *d)</td></tr>
<tr class="memdesc:gacef164c7781f3aa15928b482c3845418"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a look at the currently-loaded effect values and returns the lowest possible breeding value any (diploid) genotype could score using those effect values.  <a href="group__calculators.html#gacef164c7781f3aa15928b482c3845418">More...</a><br /></td></tr>
<tr class="separator:gacef164c7781f3aa15928b482c3845418"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>For calculations related to the loaded allele effects and internal additive breeding value model. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gab5b177cf40a7e28276c460d60a3ecbb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab5b177cf40a7e28276c460d60a3ecbb5">&#9670;&nbsp;</a></span>calculate_bvs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> calculate_bvs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_effect_matrix.html">EffectMatrix</a> *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the fitness metric/breeding value for each genotype in the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a>, and returns the results in a <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> struct. </p>
<p>The breeding value is calculated for each genotype by taking the sum of (number of copies of this allele at this marker times this allele's effect at this marker) for each marker for each different allele. To do this, the vector containing each allele's effect values is multiplied by a matrix containing the counts of that allele at each marker.</p>
<p>The function exits with error code 1 if no marker effect file is loaded.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>pointer to the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> object to which the genotypes belong. </td></tr>
    <tr><td class="paramname">e</td><td>pointer to the <a class="el" href="struct_effect_matrix.html" title="A type that stores a matrix of effect values and their names.">EffectMatrix</a> that effect values have been loaded into. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> containing the score for each individual in the group. </dd></dl>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_cgraph.png" border="0" usemap="#group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_cgraph" alt=""/></div>
<map name="group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_cgraph" id="group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_cgraph">
<area shape="rect" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix,..." alt="" coords="5,177,105,203"/>
<area shape="rect" href="group__maths.html#gad2c9cda1aab9679e0bfe3c88959213c6" title="Multiply two sets of a DecimalMatrix and vector, and add both products to the first column of a provi..." alt="" coords="159,5,318,47"/>
<area shape="rect" href="group__maths.html#gabb8addf721442aecdd7dca3dfd955c3c" title="Multiply a DecimalMatrix to a vector, and add that product to the first column of a provided DecimalM..." alt="" coords="153,71,324,112"/>
<area shape="rect" href="group__calculators.html#ga32b287af2e2955edd565eedf3043f02c" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a..." alt="" coords="161,136,317,177"/>
<area shape="rect" href="group__calculators.html#ga3e812683e26615b797eb4cd98b694d52" title="Calculates the number of times at each marker that two particular alleles appear for each genotype in..." alt="" coords="163,201,314,243"/>
<area shape="rect" href="group__deletors.html#gaaf6542d59034f88f9e1ec48e5f053c4a" title="Deletes a DecimalMatrix and frees its memory." alt="" coords="185,267,292,294"/>
<area shape="rect" href="group__maths.html#gabf3f578b0aa59d5b68ccd0738dd6a9d1" title="Generates a matrix of c columns, r rows with all 0." alt="" coords="161,318,316,345"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_icgraph.png" border="0" usemap="#group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_icgraph" alt=""/></div>
<map name="group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_icgraph" id="group__calculators_gab5b177cf40a7e28276c460d60a3ecbb5_icgraph">
<area shape="rect" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix,..." alt="" coords="441,182,541,209"/>
<area shape="rect" href="group__crossers.html#gae66231fb141a76432d1211e2cf0baf25" title="Performs random crosses among members of a group." alt="" coords="219,19,390,46"/>
<area shape="rect" href="group__crossers.html#ga3be2cb18d1c722b3a766a7a5663a8f0c" title="Performs random crosses where the first parent comes from one group and the second from another." alt="" coords="220,81,389,107"/>
<area shape="rect" href="group__crossers.html#gabb793988799d792dfe4007efdf988068" title="Performs the crosses of pairs of parents whose ids are provided in an array." alt="" coords="216,131,393,158"/>
<area shape="rect" href="group__crossers.html#gaa42e48ab06f9051e5ed6879409cbe2f4" title="Creates an identical copy of each member of a group." alt="" coords="255,182,354,209"/>
<area shape="rect" href="group__crossers.html#gaf078d6bc1b5d4234a9b960e6132480aa" title="Creates a doubled haploid from each member of a group." alt="" coords="224,233,385,259"/>
<area shape="rect" href="group__savers.html#ga6024d629560199d7c97d86bda15f55fc" title="Print the breeding value of each genotype in the SimData to a file." alt="" coords="267,283,342,310"/>
<area shape="rect" href="group__crossers.html#gadf5beb682ac15fa5a0176e480adc9d91" title="Selfs each member of a group for a certain number of generations." alt="" coords="257,334,352,361"/>
<area shape="rect" href="group__crossers.html#ga68aca99a41527b019316c8243e6fc7a7" title="Find the top m percent of a group and perform random crosses between those top individuals." alt="" coords="10,5,163,47"/>
<area shape="rect" href="group__crossers.html#ga3f1b06b7aa35e6a05918e16d1deabeee" title="Perform crosses between all pairs of parents in the group from_group and allocates the resulting offs..." alt="" coords="8,71,165,112"/>
<area shape="rect" href="group__crossers.html#ga3b67d38c13c7a8bef2d0fc91c0365177" title="Perform crosses between pairs of parents identified by name in a file and allocate the resulting offs..." alt="" coords="5,137,168,163"/>
<area shape="rect" href="group__crossers.html#gaa7c90b4015e4abce750176c6d891cad2" title="Perform crosses between previously&#45;generated offspring of pairs of parents identified by name in a fi..." alt="" coords="11,188,163,229"/>
</map>
</div>

</div>
</div>
<a id="ga32b287af2e2955edd565eedf3043f02c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga32b287af2e2955edd565eedf3043f02c">&#9670;&nbsp;</a></span>calculate_count_matrix_of_allele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_count_matrix_of_allele </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>allele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *&#160;</td>
          <td class="paramname"><em>counts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the number of times at each marker that a particular allele appears for each genotype in a particular <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> (does not go through the linked list). </p>
<p>Returns the result in a pre-created <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a>. Useful for multiplying to effect matrix to calculate breeding values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>pointer to the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> that contains the genotypes to count alleles. </td></tr>
    <tr><td class="paramname">allele</td><td>the single-character allele to be counting. </td></tr>
    <tr><td class="paramname">counts</td><td>pointer to the <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> into which to put the number of <code>allele</code> occurences at each row/marker for each column/genotype in the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, nonzero on failure. </dd></dl>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga32b287af2e2955edd565eedf3043f02c_icgraph.png" border="0" usemap="#group__calculators_ga32b287af2e2955edd565eedf3043f02c_icgraph" alt=""/></div>
<map name="group__calculators_ga32b287af2e2955edd565eedf3043f02c_icgraph" id="group__calculators_ga32b287af2e2955edd565eedf3043f02c_icgraph">
<area shape="rect" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a..." alt="" coords="589,175,745,216"/>
<area shape="rect" href="group__calculators.html#gab5b177cf40a7e28276c460d60a3ecbb5" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix,..." alt="" coords="441,182,541,209"/>
<area shape="rect" href="group__crossers.html#gae66231fb141a76432d1211e2cf0baf25" title="Performs random crosses among members of a group." alt="" coords="219,19,390,46"/>
<area shape="rect" href="group__crossers.html#ga3be2cb18d1c722b3a766a7a5663a8f0c" title="Performs random crosses where the first parent comes from one group and the second from another." alt="" coords="220,81,389,107"/>
<area shape="rect" href="group__crossers.html#gabb793988799d792dfe4007efdf988068" title="Performs the crosses of pairs of parents whose ids are provided in an array." alt="" coords="216,131,393,158"/>
<area shape="rect" href="group__crossers.html#gaa42e48ab06f9051e5ed6879409cbe2f4" title="Creates an identical copy of each member of a group." alt="" coords="255,182,354,209"/>
<area shape="rect" href="group__crossers.html#gaf078d6bc1b5d4234a9b960e6132480aa" title="Creates a doubled haploid from each member of a group." alt="" coords="224,233,385,259"/>
<area shape="rect" href="group__savers.html#ga6024d629560199d7c97d86bda15f55fc" title="Print the breeding value of each genotype in the SimData to a file." alt="" coords="267,283,342,310"/>
<area shape="rect" href="group__crossers.html#gadf5beb682ac15fa5a0176e480adc9d91" title="Selfs each member of a group for a certain number of generations." alt="" coords="257,334,352,361"/>
<area shape="rect" href="group__crossers.html#ga68aca99a41527b019316c8243e6fc7a7" title="Find the top m percent of a group and perform random crosses between those top individuals." alt="" coords="10,5,163,47"/>
<area shape="rect" href="group__crossers.html#ga3f1b06b7aa35e6a05918e16d1deabeee" title="Perform crosses between all pairs of parents in the group from_group and allocates the resulting offs..." alt="" coords="8,71,165,112"/>
<area shape="rect" href="group__crossers.html#ga3b67d38c13c7a8bef2d0fc91c0365177" title="Perform crosses between pairs of parents identified by name in a file and allocate the resulting offs..." alt="" coords="5,137,168,163"/>
<area shape="rect" href="group__crossers.html#gaa7c90b4015e4abce750176c6d891cad2" title="Perform crosses between previously&#45;generated offspring of pairs of parents identified by name in a fi..." alt="" coords="11,188,163,229"/>
</map>
</div>

</div>
</div>
<a id="ga3e812683e26615b797eb4cd98b694d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e812683e26615b797eb4cd98b694d52">&#9670;&nbsp;</a></span>calculate_doublecount_matrix_of_allele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_doublecount_matrix_of_allele </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>allele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *&#160;</td>
          <td class="paramname"><em>counts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>allele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *&#160;</td>
          <td class="paramname"><em>counts2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the number of times at each marker that two particular alleles appear for each genotype in an <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> (does not go through the linked list). </p>
<p>Returns the result in two pre-created <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a>. Useful for multiplying to effect matrix to calculate breeding values.</p>
<p>This function is the same as <a class="el" href="group__calculators.html#ga32b287af2e2955edd565eedf3043f02c" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a...">calculate_count_matrix_of_allele()</a>, but for two alleles at a time, for the purpose of loop unrolling in breeding value calculations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>pointer to the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> that contains the genotypes to count alleles. </td></tr>
    <tr><td class="paramname">allele</td><td>the first single-character allele to be counting. </td></tr>
    <tr><td class="paramname">counts</td><td>pointer to the <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> into which to put the number of <code>allele</code> occurences at each row/marker for each column/genotype in the group. </td></tr>
    <tr><td class="paramname">allele2</td><td>the second single-character allele to be counting. </td></tr>
    <tr><td class="paramname">counts2</td><td>pointer to the <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> into which to put the number of <code>allele2</code> occurences at each row/marker for each column/genotype in the group. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, nonzero on failure. </dd></dl>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga3e812683e26615b797eb4cd98b694d52_icgraph.png" border="0" usemap="#group__calculators_ga3e812683e26615b797eb4cd98b694d52_icgraph" alt=""/></div>
<map name="group__calculators_ga3e812683e26615b797eb4cd98b694d52_icgraph" id="group__calculators_ga3e812683e26615b797eb4cd98b694d52_icgraph">
<area shape="rect" title="Calculates the number of times at each marker that two particular alleles appear for each genotype in..." alt="" coords="589,175,740,216"/>
<area shape="rect" href="group__calculators.html#gab5b177cf40a7e28276c460d60a3ecbb5" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix,..." alt="" coords="441,182,541,209"/>
<area shape="rect" href="group__crossers.html#gae66231fb141a76432d1211e2cf0baf25" title="Performs random crosses among members of a group." alt="" coords="219,19,390,46"/>
<area shape="rect" href="group__crossers.html#ga3be2cb18d1c722b3a766a7a5663a8f0c" title="Performs random crosses where the first parent comes from one group and the second from another." alt="" coords="220,81,389,107"/>
<area shape="rect" href="group__crossers.html#gabb793988799d792dfe4007efdf988068" title="Performs the crosses of pairs of parents whose ids are provided in an array." alt="" coords="216,131,393,158"/>
<area shape="rect" href="group__crossers.html#gaa42e48ab06f9051e5ed6879409cbe2f4" title="Creates an identical copy of each member of a group." alt="" coords="255,182,354,209"/>
<area shape="rect" href="group__crossers.html#gaf078d6bc1b5d4234a9b960e6132480aa" title="Creates a doubled haploid from each member of a group." alt="" coords="224,233,385,259"/>
<area shape="rect" href="group__savers.html#ga6024d629560199d7c97d86bda15f55fc" title="Print the breeding value of each genotype in the SimData to a file." alt="" coords="267,283,342,310"/>
<area shape="rect" href="group__crossers.html#gadf5beb682ac15fa5a0176e480adc9d91" title="Selfs each member of a group for a certain number of generations." alt="" coords="257,334,352,361"/>
<area shape="rect" href="group__crossers.html#ga68aca99a41527b019316c8243e6fc7a7" title="Find the top m percent of a group and perform random crosses between those top individuals." alt="" coords="10,5,163,47"/>
<area shape="rect" href="group__crossers.html#ga3f1b06b7aa35e6a05918e16d1deabeee" title="Perform crosses between all pairs of parents in the group from_group and allocates the resulting offs..." alt="" coords="8,71,165,112"/>
<area shape="rect" href="group__crossers.html#ga3b67d38c13c7a8bef2d0fc91c0365177" title="Perform crosses between pairs of parents identified by name in a file and allocate the resulting offs..." alt="" coords="5,137,168,163"/>
<area shape="rect" href="group__crossers.html#gaa7c90b4015e4abce750176c6d891cad2" title="Perform crosses between previously&#45;generated offspring of pairs of parents identified by name in a fi..." alt="" coords="11,188,163,229"/>
</map>
</div>

</div>
</div>
<a id="ga42f2398ccb53ffafce9b4a17e3222636"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42f2398ccb53ffafce9b4a17e3222636">&#9670;&nbsp;</a></span>calculate_full_count_matrix_of_allele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> calculate_full_count_matrix_of_allele </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>allele</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the number of times at each marker that a particular allele appears for each genotype in the linked list starting at the given <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a>. </p>
<p>Returns the result as a <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a>. Useful for multiplying to effect matrix to calculate breeding values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>pointer to the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> that contains the genotypes to count alleles. </td></tr>
    <tr><td class="paramname">allele</td><td>the single-character allele to be counting. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> containing counts for every genotype in the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> linked list. </dd></dl>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_cgraph.png" border="0" usemap="#group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_cgraph" alt=""/></div>
<map name="group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_cgraph" id="group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_cgraph">
<area shape="rect" title="Calculates the number of times at each marker that a particular allele appears for each genotype in t..." alt="" coords="5,5,141,47"/>
<area shape="rect" href="group__maths.html#gabf3f578b0aa59d5b68ccd0738dd6a9d1" title="Generates a matrix of c columns, r rows with all 0." alt="" coords="189,13,344,39"/>
</map>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_icgraph.png" border="0" usemap="#group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_icgraph" alt=""/></div>
<map name="group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_icgraph" id="group__calculators_ga42f2398ccb53ffafce9b4a17e3222636_icgraph">
<area shape="rect" title="Calculates the number of times at each marker that a particular allele appears for each genotype in t..." alt="" coords="184,5,320,47"/>
<area shape="rect" href="group__savers.html#ga490906a5bfdb22b90aba5cdf6282fd03" title="Print the number of copies of a particular allele at each marker of each genotype in the SimData to a..." alt="" coords="5,13,136,39"/>
</map>
</div>

</div>
</div>
<a id="ga7f80905718ac87e9da1c30a2cec77ea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f80905718ac87e9da1c30a2cec77ea6">&#9670;&nbsp;</a></span>calculate_group_bvs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> calculate_group_bvs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the fitness metric/breeding value for each genotype in the <a class="el" href="struct_allele_matrix.html">AlleleMatrix</a> in a certain group, and returns the results in a <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a>. </p>
<p>The breeding value is calculated for each genotype by taking the sum of (number of copies of this allele at this marker times this allele's effect at this marker) for each marker for each different allele. To do this, the vector containing each allele's effect values is multiplied by a matrix containing the counts of that allele at each marker.</p>
<p>The function exits with error code 1 if no marker effect file is loaded.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> object to which the groups and individuals belong. It must have a marker effect file loaded to successfully run this function. </td></tr>
    <tr><td class="paramname">group</td><td>calculate breeding values for each genotype in the group with this group number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> containing the score for each individual in the group. </dd></dl>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_cgraph.png" border="0" usemap="#group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_cgraph" alt=""/></div>
<map name="group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_cgraph" id="group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_cgraph">
<area shape="rect" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix in a certain group..." alt="" coords="5,195,144,222"/>
<area shape="rect" href="group__maths.html#gad2c9cda1aab9679e0bfe3c88959213c6" title="Multiply two sets of a DecimalMatrix and vector, and add both products to the first column of a provi..." alt="" coords="208,5,367,47"/>
<area shape="rect" href="group__maths.html#gabb8addf721442aecdd7dca3dfd955c3c" title="Multiply a DecimalMatrix to a vector, and add that product to the first column of a provided DecimalM..." alt="" coords="202,71,373,112"/>
<area shape="rect" href="group__calculators.html#gad86ea5492e6c1cf918d6449a9eb530de" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a..." alt="" coords="211,253,363,295"/>
<area shape="rect" href="group__getters.html#gad6d2b66296cd80f5bfe303e06de7935c" title="Function to count the number of genotypes that currently belong to the specified group." alt="" coords="600,187,711,214"/>
<area shape="rect" href="group__calculators.html#ga0b2b686b9dde986b549f15d72fa4c919" title="Calculates the number of times at each marker that two particular alleles appear for each genotype in..." alt="" coords="192,188,383,229"/>
<area shape="rect" href="group__deletors.html#gaaf6542d59034f88f9e1ec48e5f053c4a" title="Deletes a DecimalMatrix and frees its memory." alt="" coords="234,319,341,346"/>
<area shape="rect" href="group__maths.html#gabf3f578b0aa59d5b68ccd0738dd6a9d1" title="Generates a matrix of c columns, r rows with all 0." alt="" coords="210,370,365,397"/>
<area shape="rect" href="group__getters.html#gac159a31261e14b325bd623899eefa796" title="Gets a shallow copy of the genes/alleles of each member of the group." alt="" coords="431,238,552,265"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="613,238,698,265"/>
</map>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_icgraph.png" border="0" usemap="#group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_icgraph" alt=""/></div>
<map name="group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_icgraph" id="group__calculators_ga7f80905718ac87e9da1c30a2cec77ea6_icgraph">
<area shape="rect" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix in a certain group..." alt="" coords="368,56,507,83"/>
<area shape="rect" href="group__getters.html#gaacbc190e8ea144de14b586e5fe3ae865" title="Gets the breeding values/breeding values/fitnesses of each member of the group." alt="" coords="211,5,316,32"/>
<area shape="rect" href="group__savers.html#ga0da46978e8e546af5eb3b2635902a82b" title="Print the breeding value of each genotype in a group to a file." alt="" coords="207,56,320,83"/>
<area shape="rect" href="group__calculators.html#gae34db60faf62b898d0572ea6c039b96a" title="Takes the top_n individuals in the group with the best breeding values/fitnesses and puts them in a n..." alt="" coords="220,107,307,133"/>
<area shape="rect" href="group__crossers.html#ga68aca99a41527b019316c8243e6fc7a7" title="Find the top m percent of a group and perform random crosses between those top individuals." alt="" coords="5,99,159,141"/>
</map>
</div>

</div>
</div>
<a id="gad86ea5492e6c1cf918d6449a9eb530de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad86ea5492e6c1cf918d6449a9eb530de">&#9670;&nbsp;</a></span>calculate_group_count_matrix_of_allele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_group_count_matrix_of_allele </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>allele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *&#160;</td>
          <td class="paramname"><em>counts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the number of times at each marker that a particular allele appears for each genotype in a group. </p>
<p>Returns the result in a pre-created <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a>. Useful for multiplying to effect matrix to calculate breeding values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a>. </td></tr>
    <tr><td class="paramname">group</td><td>group number for which to calculate counts of the allele </td></tr>
    <tr><td class="paramname">allele</td><td>the single-character allele to be counting. </td></tr>
    <tr><td class="paramname">counts</td><td>pointer to the <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> into which to put the number of <code>allele</code> occurences at each row/marker for each column/genotype in the group. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, nonzero on failure. </dd></dl>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_cgraph.png" border="0" usemap="#group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_cgraph" alt=""/></div>
<map name="group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_cgraph" id="group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_cgraph">
<area shape="rect" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a..." alt="" coords="5,23,157,65"/>
<area shape="rect" href="group__getters.html#gac159a31261e14b325bd623899eefa796" title="Gets a shallow copy of the genes/alleles of each member of the group." alt="" coords="205,56,327,83"/>
<area shape="rect" href="group__getters.html#gad6d2b66296cd80f5bfe303e06de7935c" title="Function to count the number of genotypes that currently belong to the specified group." alt="" coords="375,5,485,32"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="387,56,473,83"/>
</map>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_icgraph.png" border="0" usemap="#group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_icgraph" alt=""/></div>
<map name="group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_icgraph" id="group__calculators_gad86ea5492e6c1cf918d6449a9eb530de_icgraph">
<area shape="rect" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a..." alt="" coords="563,78,715,119"/>
<area shape="rect" href="group__calculators.html#ga7f80905718ac87e9da1c30a2cec77ea6" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix in a certain group..." alt="" coords="372,56,511,83"/>
<area shape="rect" href="group__savers.html#gab732ec2d648a6dc01444ef74f780fc70" title="Print the number of copies of a particular allele at each marker of each genotype in a group to a fil..." alt="" coords="368,107,515,149"/>
<area shape="rect" href="group__getters.html#gaacbc190e8ea144de14b586e5fe3ae865" title="Gets the breeding values/breeding values/fitnesses of each member of the group." alt="" coords="211,5,316,32"/>
<area shape="rect" href="group__savers.html#ga0da46978e8e546af5eb3b2635902a82b" title="Print the breeding value of each genotype in a group to a file." alt="" coords="207,56,320,83"/>
<area shape="rect" href="group__calculators.html#gae34db60faf62b898d0572ea6c039b96a" title="Takes the top_n individuals in the group with the best breeding values/fitnesses and puts them in a n..." alt="" coords="220,107,307,133"/>
<area shape="rect" href="group__crossers.html#ga68aca99a41527b019316c8243e6fc7a7" title="Find the top m percent of a group and perform random crosses between those top individuals." alt="" coords="5,99,159,141"/>
</map>
</div>

</div>
</div>
<a id="ga0b2b686b9dde986b549f15d72fa4c919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b2b686b9dde986b549f15d72fa4c919">&#9670;&nbsp;</a></span>calculate_group_doublecount_matrix_of_allele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_group_doublecount_matrix_of_allele </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>allele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *&#160;</td>
          <td class="paramname"><em>counts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>allele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_decimal_matrix.html">DecimalMatrix</a> *&#160;</td>
          <td class="paramname"><em>counts2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the number of times at each marker that two particular alleles appear for each genotype in a group. </p>
<p>Returns the result in two pre-created <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a>. Useful for multiplying to effect matrix to calculate breeding values.</p>
<p>This function is the same as <a class="el" href="group__calculators.html#gad86ea5492e6c1cf918d6449a9eb530de" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a...">calculate_group_count_matrix_of_allele()</a>, but for two alleles at a time, for the purpose of loop unrolling in breeding value calculations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a>. </td></tr>
    <tr><td class="paramname">group</td><td>group number for which to calculate counts of the allele </td></tr>
    <tr><td class="paramname">allele</td><td>the first single-character allele to be counting. </td></tr>
    <tr><td class="paramname">counts</td><td>pointer to the <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> into which to put the number of <code>allele</code> occurences at each row/marker for each column/genotype in the group. </td></tr>
    <tr><td class="paramname">allele2</td><td>the second single-character allele to be counting. </td></tr>
    <tr><td class="paramname">counts2</td><td>pointer to the <a class="el" href="struct_decimal_matrix.html" title="A row-major heap matrix that contains floating point numbers.">DecimalMatrix</a> into which to put the number of <code>allele2</code> occurences at each row/marker for each column/genotype in the group. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, nonzero on failure. </dd></dl>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_cgraph.png" border="0" usemap="#group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_cgraph" alt=""/></div>
<map name="group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_cgraph" id="group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_cgraph">
<area shape="rect" title="Calculates the number of times at each marker that two particular alleles appear for each genotype in..." alt="" coords="5,23,196,65"/>
<area shape="rect" href="group__getters.html#gac159a31261e14b325bd623899eefa796" title="Gets a shallow copy of the genes/alleles of each member of the group." alt="" coords="244,56,365,83"/>
<area shape="rect" href="group__getters.html#gad6d2b66296cd80f5bfe303e06de7935c" title="Function to count the number of genotypes that currently belong to the specified group." alt="" coords="413,5,524,32"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="426,56,511,83"/>
</map>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_icgraph.png" border="0" usemap="#group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_icgraph" alt=""/></div>
<map name="group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_icgraph" id="group__calculators_ga0b2b686b9dde986b549f15d72fa4c919_icgraph">
<area shape="rect" title="Calculates the number of times at each marker that two particular alleles appear for each genotype in..." alt="" coords="555,49,745,90"/>
<area shape="rect" href="group__calculators.html#ga7f80905718ac87e9da1c30a2cec77ea6" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix in a certain group..." alt="" coords="368,56,507,83"/>
<area shape="rect" href="group__getters.html#gaacbc190e8ea144de14b586e5fe3ae865" title="Gets the breeding values/breeding values/fitnesses of each member of the group." alt="" coords="211,5,316,32"/>
<area shape="rect" href="group__savers.html#ga0da46978e8e546af5eb3b2635902a82b" title="Print the breeding value of each genotype in a group to a file." alt="" coords="207,56,320,83"/>
<area shape="rect" href="group__calculators.html#gae34db60faf62b898d0572ea6c039b96a" title="Takes the top_n individuals in the group with the best breeding values/fitnesses and puts them in a n..." alt="" coords="220,107,307,133"/>
<area shape="rect" href="group__crossers.html#ga68aca99a41527b019316c8243e6fc7a7" title="Find the top m percent of a group and perform random crosses between those top individuals." alt="" coords="5,99,159,141"/>
</map>
</div>

</div>
</div>
<a id="ga8fdd3011c2ce5228c8c8d6486533369b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8fdd3011c2ce5228c8c8d6486533369b">&#9670;&nbsp;</a></span>calculate_group_local_bvs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_group_local_bvs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_marker_blocks.html">MarkerBlocks</a>&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a set of blocks of markers in a file, for each genotype in a group, calculate the local fitness metric/breeding value for the first allele at each marker in the block, and the local fitness metric/breeding value for the second allele at each marker in the block, then save the result to a file. </p>
<p>This gives block effects/local BVs for each haplotype of each individual in the group.</p>
<p>The output file will have format:</p>
<p>[genotype name]_1 [effect for first block, first allele] [effect for second block, second allele] ...</p>
<p>[genotype name]_2 [effect for first block, second allele] [effect for second block, second allele] ...</p>
<p>[genotype 2 name]_1 ...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> object to which the groups and individuals belong. It must have a marker effect file loaded to successfully run this function. </td></tr>
    <tr><td class="paramname">b</td><td>struct containing the blocks to use </td></tr>
    <tr><td class="paramname">output_file</td><td>string containing the filename of the file to which output block effects/local BVs will be saved. </td></tr>
    <tr><td class="paramname">group</td><td>group number from which to split the top individuals. </td></tr>
  </table>
  </dd>
</dl>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga8fdd3011c2ce5228c8c8d6486533369b_cgraph.png" border="0" usemap="#group__calculators_ga8fdd3011c2ce5228c8c8d6486533369b_cgraph" alt=""/></div>
<map name="group__calculators_ga8fdd3011c2ce5228c8c8d6486533369b_cgraph" id="group__calculators_ga8fdd3011c2ce5228c8c8d6486533369b_cgraph">
<area shape="rect" title="Given a set of blocks of markers in a file, for each genotype in a group, calculate the local fitness..." alt="" coords="5,22,179,49"/>
<area shape="rect" href="group__getters.html#gac159a31261e14b325bd623899eefa796" title="Gets a shallow copy of the genes/alleles of each member of the group." alt="" coords="229,73,350,99"/>
<area shape="rect" href="group__getters.html#gad6d2b66296cd80f5bfe303e06de7935c" title="Function to count the number of genotypes that currently belong to the specified group." alt="" coords="400,22,511,49"/>
<area shape="rect" href="group__getters.html#ga3e00f06acc41eb012e99ae46d7a18ccc" title="Gets a shallow copy of the names of each member of the group." alt="" coords="227,22,352,49"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="413,73,498,99"/>
</map>
</div>

</div>
</div>
<a id="ga7c6e2c2f4447accd4a30031256c1610a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c6e2c2f4447accd4a30031256c1610a">&#9670;&nbsp;</a></span>calculate_local_bvs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_local_bvs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_marker_blocks.html">MarkerBlocks</a>&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>output_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a set of blocks of markers in a file, for each genotype saved, calculate the local BV for the first allele at each marker in the block, and the local BV for the second allele at each marker in the block, then save the result to a file. </p>
<p>This gives block effects for each haplotype of each individual currently saved to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a>.</p>
<p>The output file will have format:</p>
<p>[genotype name]_1 [effect for first block, first allele] [effect for second block, second allele] ...</p>
<p>[genotype name]_2 [effect for first block, second allele] [effect for second block, second allele] ...</p>
<p>[genotype 2 name]_1 ...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> object to which individuals belong. It must have a marker effect file loaded to successfully run this function. </td></tr>
    <tr><td class="paramname">b</td><td>struct containing the blocks to use </td></tr>
    <tr><td class="paramname">output_file</td><td>string containing the filename of the file to which output block effects/local BV will be saved. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gacef164c7781f3aa15928b482c3845418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacef164c7781f3aa15928b482c3845418">&#9670;&nbsp;</a></span>calculate_minimum_bv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calculate_minimum_bv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes a look at the currently-loaded effect values and returns the lowest possible breeding value any (diploid) genotype could score using those effect values. </p>
<p>The <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> must be initialised with marker effects for this function to succeed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> containing markers and marker effects. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the fitness metric/breeding value of the worst genotype. </dd></dl>

</div>
</div>
<a id="gadf9a424cc9474272059ff328bfadf755"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf9a424cc9474272059ff328bfadf755">&#9670;&nbsp;</a></span>calculate_optimal_alleles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* calculate_optimal_alleles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes a look at the currently-loaded effect values and creates a string containing the allele with the highest effect value for each marker as ordered in the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a>. </p>
<p>Returns this as a null-terminated heap array of characters of length d-&gt;n_markers + one null byte.</p>
<p>The return value should be freed when usage is finished!</p>
<p>The <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> must be initialised with marker effects for this function to succeed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> containing markers and marker effects. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a heap array filled with a null-terminated string containing the highest scoring allele at each marker. </dd></dl>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_gadf9a424cc9474272059ff328bfadf755_cgraph.png" border="0" usemap="#group__calculators_gadf9a424cc9474272059ff328bfadf755_cgraph" alt=""/></div>
<map name="group__calculators_gadf9a424cc9474272059ff328bfadf755_cgraph" id="group__calculators_gadf9a424cc9474272059ff328bfadf755_cgraph">
<area shape="rect" title="Takes a look at the currently&#45;loaded effect values and creates a string containing the allele with th..." alt="" coords="5,5,172,32"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="220,5,305,32"/>
</map>
</div>

</div>
</div>
<a id="ga67d98ae97e5352f32380c8b89b1e4047"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67d98ae97e5352f32380c8b89b1e4047">&#9670;&nbsp;</a></span>calculate_optimum_bv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calculate_optimum_bv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes a look at the currently-loaded effect values and returns the highest possible breeding value any (diploid) genotype could have using those effect values. </p>
<p>The <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> must be initialised with marker effects for this function to succeed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> containing markers and marker effects. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the fitness metric/breeding value of the best/ideal genotype. </dd></dl>

</div>
</div>
<a id="ga2f61debfc95036e86953f6111236026f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f61debfc95036e86953f6111236026f">&#9670;&nbsp;</a></span>create_n_blocks_by_chr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_marker_blocks.html">MarkerBlocks</a> create_n_blocks_by_chr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Divide the genotype into blocks where each block contains all markers within a 1/n length section of each chromosome in the map, and return the resulting blocks in a struct. </p>
<p>Chromosomes where there are no markers tracked are excluded/no blocks are created in those chromosomes.</p>
<p>Chromosomes where only one marker is tracked put the marker in the first block, and have all other blocks empty.</p>
<p>Empty blocks have blocks.num_markers_in_block[index] equal to 0 and contain a null pointer at blocks.markers_in_block[index].</p>
<p>Remember to call the <a class="el" href="struct_marker_blocks.html" title="A struct used to store a set of blocks of markers.">MarkerBlocks</a> destructor <a class="el" href="group__deletors.html#gaea2a41cc103e8d11bedff564f93a4759" title="Deletes a MarkerBlocks object and frees its associated memory.">delete_markerblocks()</a> on the returned struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> object to which the groups and individuals belong. It must have a marker effect file loaded to successfully run this function. </td></tr>
    <tr><td class="paramname">n</td><td>number of blocks into which to split each chromosome. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a struct containing the markers identified as belonging to each block. </dd></dl>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga2f61debfc95036e86953f6111236026f_cgraph.png" border="0" usemap="#group__calculators_ga2f61debfc95036e86953f6111236026f_cgraph" alt=""/></div>
<map name="group__calculators_ga2f61debfc95036e86953f6111236026f_cgraph" id="group__calculators_ga2f61debfc95036e86953f6111236026f_cgraph">
<area shape="rect" title="Divide the genotype into blocks where each block contains all markers within a 1/n length section of ..." alt="" coords="5,5,168,32"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="216,5,301,32"/>
</map>
</div>

</div>
</div>
<a id="ga463082fc380a6815f07bd06401927bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga463082fc380a6815f07bd06401927bc0">&#9670;&nbsp;</a></span>read_block_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_marker_blocks.html">MarkerBlocks</a> read_block_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>block_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a file containing definitions of blocks of markers, process that file and return a struct containing the definitions of those blocks. </p>
<p>The block file is designed after the output from a call to the R SelectionTools package's <code>st.def.hblocks</code> function. It should have the format (tab-separated):</p>
<p>Chrom Pos Name Class Markers</p>
<p>[ignored] [ignored] [ignored] [ignored] [semicolon];[separated];[list] ;[of];[marker];[names];[belonging];[to];[this];[block];</p>
<p>...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> object to which the groups and individuals belong. It must have a marker effect file loaded to successfully run this function. </td></tr>
    <tr><td class="paramname">block_file</td><td>string containing filename of the file with blocks </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a struct containing the markers identified as belonging to each block according to their definitions in the file. </dd></dl>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_ga463082fc380a6815f07bd06401927bc0_cgraph.png" border="0" usemap="#group__calculators_ga463082fc380a6815f07bd06401927bc0_cgraph" alt=""/></div>
<map name="group__calculators_ga463082fc380a6815f07bd06401927bc0_cgraph" id="group__calculators_ga463082fc380a6815f07bd06401927bc0_cgraph">
<area shape="rect" title="Given a file containing definitions of blocks of markers, process that file and return a struct conta..." alt="" coords="5,64,113,91"/>
<area shape="rect" href="group__supporters.html#ga392c23248f22e9faf085198dbb1d8711" title="Opens a table file and reads the number of columns and rows (including headers) separated by sep into..." alt="" coords="161,5,297,32"/>
<area shape="rect" href="group__supporters.html#gaed2ae969c3ce4ed1466a885dcc559472" title="Returns the first located index in an array of strings where the string is the same as the string tar..." alt="" coords="161,57,297,98"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="187,123,272,149"/>
</map>
</div>

</div>
</div>
<a id="gae34db60faf62b898d0572ea6c039b96a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae34db60faf62b898d0572ea6c039b96a">&#9670;&nbsp;</a></span>split_by_bv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int split_by_bv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sim_data.html">SimData</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>top_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lowIsBest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes the <code>top_n</code> individuals in the group with the best breeding values/fitnesses and puts them in a new group. </p>
<p>The new group number is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to the <a class="el" href="struct_sim_data.html" title="Composite type that is used to run crossing simulations.">SimData</a> object to which the groups and individuals belong. It must have a marker effect file loaded to successfully run this function. </td></tr>
    <tr><td class="paramname">group</td><td>group number from which to split the top individuals. </td></tr>
    <tr><td class="paramname">top_n</td><td>The number of individuals to put in the new group. </td></tr>
    <tr><td class="paramname">lowIsBest</td><td>boolean, if TRUE the <code>top_n</code> with the lowest breeding value will be selected, if false the <code>top_n</code> with the highest breeding value are. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the group number of the newly-created split-off group </dd></dl>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_gae34db60faf62b898d0572ea6c039b96a_cgraph.png" border="0" usemap="#group__calculators_gae34db60faf62b898d0572ea6c039b96a_cgraph" alt=""/></div>
<map name="group__calculators_gae34db60faf62b898d0572ea6c039b96a_cgraph" id="group__calculators_gae34db60faf62b898d0572ea6c039b96a_cgraph">
<area shape="rect" title="Takes the top_n individuals in the group with the best breeding values/fitnesses and puts them in a n..." alt="" coords="5,356,92,383"/>
<area shape="rect" href="group__supporters.html#ga311381904a1ca73ea26dfede9fcddea2" title="Comparator function for qsort." alt="" coords="140,5,335,32"/>
<area shape="rect" href="group__supporters.html#ga2aae9a568cd0cd5313808e458a9fe388" title="Comparator function for qsort." alt="" coords="167,57,307,98"/>
<area shape="rect" href="group__calculators.html#ga7f80905718ac87e9da1c30a2cec77ea6" title="Calculates the fitness metric/breeding value for each genotype in the AlleleMatrix in a certain group..." alt="" coords="168,356,307,383"/>
<area shape="rect" href="group__getters.html#gad6d2b66296cd80f5bfe303e06de7935c" title="Function to count the number of genotypes that currently belong to the specified group." alt="" coords="838,249,949,276"/>
<area shape="rect" href="group__deletors.html#gaaf6542d59034f88f9e1ec48e5f053c4a" title="Deletes a DecimalMatrix and frees its memory." alt="" coords="425,539,531,565"/>
<area shape="rect" href="group__getters.html#gad9ba7de2a9960161e8417c1a611d87a6" title="Gets the indexes (0&#45;based, from the start of the linked list in the SimData) of each member of the gr..." alt="" coords="625,376,756,403"/>
<area shape="rect" href="group__groupmod.html#gaf2eda46d016c384b166ce65605952b7c" title="Take a list of indexes and allocate the genotypes at those indexes to a new group." alt="" coords="179,640,296,667"/>
<area shape="rect" href="group__maths.html#gad2c9cda1aab9679e0bfe3c88959213c6" title="Multiply two sets of a DecimalMatrix and vector, and add both products to the first column of a provi..." alt="" coords="399,407,557,449"/>
<area shape="rect" href="group__maths.html#gabb8addf721442aecdd7dca3dfd955c3c" title="Multiply a DecimalMatrix to a vector, and add that product to the first column of a provided DecimalM..." alt="" coords="393,473,563,514"/>
<area shape="rect" href="group__calculators.html#gad86ea5492e6c1cf918d6449a9eb530de" title="Calculates the number of times at each marker that a particular allele appears for each genotype in a..." alt="" coords="402,225,554,266"/>
<area shape="rect" href="group__calculators.html#ga0b2b686b9dde986b549f15d72fa4c919" title="Calculates the number of times at each marker that two particular alleles appear for each genotype in..." alt="" coords="383,290,573,331"/>
<area shape="rect" href="group__maths.html#gabf3f578b0aa59d5b68ccd0738dd6a9d1" title="Generates a matrix of c columns, r rows with all 0." alt="" coords="401,356,555,383"/>
<area shape="rect" href="group__getters.html#gac159a31261e14b325bd623899eefa796" title="Gets a shallow copy of the genes/alleles of each member of the group." alt="" coords="630,275,751,301"/>
<area shape="rect" href="group__supporters.html#gad1a5b9f3e850da13931ee02fbb170d41" title="Replace calls to malloc direct with this function, which errors and exits with status 2 if memory all..." alt="" coords="851,339,936,365"/>
<area shape="rect" href="group__supporters.html#gadae2e9f7e1061cb20426ba2333b7629b" title="Comparator function for qsort." alt="" coords="808,665,979,692"/>
<area shape="rect" href="group__supporters.html#gae974a74145fe876e303e14336d3c5d3a" title="Function to identify the next sequential integer that does not identify a group that currently has me..." alt="" coords="407,691,549,717"/>
<area shape="rect" href="group__getters.html#ga3305ddcc29138d2d92689f39a7885ca0" title="Identify every group number that currently has members." alt="" coords="621,691,760,717"/>
</map>
</div>
<div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__calculators_gae34db60faf62b898d0572ea6c039b96a_icgraph.png" border="0" usemap="#group__calculators_gae34db60faf62b898d0572ea6c039b96a_icgraph" alt=""/></div>
<map name="group__calculators_gae34db60faf62b898d0572ea6c039b96a_icgraph" id="group__calculators_gae34db60faf62b898d0572ea6c039b96a_icgraph">
<area shape="rect" title="Takes the top_n individuals in the group with the best breeding values/fitnesses and puts them in a n..." alt="" coords="207,13,293,39"/>
<area shape="rect" href="group__crossers.html#ga68aca99a41527b019316c8243e6fc7a7" title="Find the top m percent of a group and perform random crosses between those top individuals." alt="" coords="5,5,159,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
