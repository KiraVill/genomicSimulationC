<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>genomicSimulationC: Features and Templates Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">genomicSimulationC<span id="projectnumber">&#160;0.2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Features and Templates Guide </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md6">Setting Up</a><ul><li class="level2"><a href="#autotoc_md7">Load a genetic map and a set of founder genotypes</a></li>
<li class="level2"><a href="#autotoc_md8">Load a genetic map and several sets of founder genotypes</a></li>
<li class="level2"><a href="#autotoc_md9">Load a genetic map, a set of founder genotypes, and a set of additive trait effects</a></li>
<li class="level2"><a href="#autotoc_md10">Swap out the set of additive trait effects for another</a></li>
<li class="level2"><a href="#autotoc_md11">Input file formats:</a><ul><li class="level3"><a href="#autotoc_md12">Loading from other file formats</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md13">Crossing &amp; Other Ways to Generate New Genotypes: Plant-themed</a><ul><li class="level2"><a href="#autotoc_md14">Single seed descent</a></li>
<li class="level2"><a href="#autotoc_md15">Creating halfsib or fullsib families</a></li>
<li class="level2"><a href="#autotoc_md16">Updating marker effects</a></li>
<li class="level2"><a href="#autotoc_md17">Trials and locations</a></li>
<li class="level2"><a href="#autotoc_md18">Backcrossing</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md19">Crossing &amp; Other Ways to Generate New Genotypes: Animal-themed</a><ul><li class="level2"><a href="#autotoc_md20">Split offspring into male and female</a></li>
<li class="level2"><a href="#autotoc_md21">Introducing fresh blood to separate male and female kernels</a></li>
<li class="level2"><a href="#autotoc_md22">Random mating with caps on number of offspring per animal</a></li>
<li class="level2"><a href="#autotoc_md23">Mating all females to a good male</a></li>
<li class="level2"><a href="#autotoc_md24">Making specific chosen matings</a></li>
<li class="level2"><a href="#autotoc_md25">Tracking age and discarding individuals that are &#39;too old&#39;</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md26">Selection</a><ul><li class="level2"><a href="#autotoc_md27">Manually select on true breeding value</a></li>
<li class="level2"><a href="#autotoc_md28">Select on phenotype (simulated with a given heritability)</a></li>
<li class="level2"><a href="#autotoc_md29">Select on a qualitative trait</a></li>
<li class="level2"><a href="#autotoc_md30">Select on a qualitative trait, then a quantitative trait.</a></li>
<li class="level2"><a href="#autotoc_md31">Select on an index weighting two traits.</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p ><a class="anchor" id="md_Templates"></a></p>
<p >While the documentation pages of genomicSimulationC and its counterpart <a href="https://github.com/vllrs/genomicSimulation">genomicSimulation</a> do describe all the features the simulation tool offers, they don't do so in a way that is necessarily easy to browse or that's helpful for new users to understand the simulation tool.</p>
<p >This page provides a set of templates for implementing common breeding project actions in genomicSimulationC and its R counterpart.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Setting Up</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
Load a genetic map and a set of founder genotypes</h2>
<table class="doxtable">
<tr>
<th>Task </th><th>Input Files </th><th>genomicSimulationC (C) </th><th>genomicSimulation (R) </th></tr>
<tr>
<td></td><td><p class="starttd">Genotype file/Allele file:</p><ul>
<li>File location: genotype-file.txt</li>
<li>File contents: <div class="fragment"><div class="line">name    G01 G02 G03 G04 G05 G06</div>
<div class="line">m1  TT  TT  TT  TA  TT  AT</div>
<div class="line">m3  TT  TT  TA  TA  TT  TT</div>
<div class="line">m2  AA  AA  AA  AA  TT  AA</div>
</div><!-- fragment --></li>
</ul>
<p class="endtd">Map file:</p><ul>
<li>File location: map-file.txt</li>
<li>File contents: <div class="fragment"><div class="line">marker chr pos</div>
<div class="line">m3 3 15</div>
<div class="line">m2 1 8.3</div>
<div class="line">m1 1 5.2</div>
</div><!-- fragment --> </li>
</ul>
</td><td><div class="fragment"><div class="line"><a class="code hl_struct" href="struct_sim_data.html">SimData</a>* d = <a class="code hl_function" href="group__loaders.html#gaf7350bdc690b7cb5592892858d2830a9">create_empty_simdata</a>();</div>
<div class="line"><span class="keywordtype">int</span> founders = <a class="code hl_function" href="group__loaders.html#ga54cd625669413c2ef171060e9844d814">load_all_simdata</a>(d, <span class="stringliteral">&quot;genotype-file.txt&quot;</span>, <span class="stringliteral">&quot;map-file.txt&quot;</span>, NULL);</div>
<div class="ttc" id="agroup__loaders_html_ga54cd625669413c2ef171060e9844d814"><div class="ttname"><a href="group__loaders.html#ga54cd625669413c2ef171060e9844d814">load_all_simdata</a></div><div class="ttdeci">int load_all_simdata(SimData *d, const char *data_file, const char *map_file, const char *effect_file)</div><div class="ttdoc">Populates a SimData combination from scratch with marker allele data, a genetic map,...</div><div class="ttdef"><b>Definition:</b> sim-operations.c:3792</div></div>
<div class="ttc" id="agroup__loaders_html_gaf7350bdc690b7cb5592892858d2830a9"><div class="ttname"><a href="group__loaders.html#gaf7350bdc690b7cb5592892858d2830a9">create_empty_simdata</a></div><div class="ttdeci">SimData * create_empty_simdata()</div><div class="ttdoc">Creator for an empty SimData object on the heap.</div><div class="ttdef"><b>Definition:</b> sim-operations.c:87</div></div>
<div class="ttc" id="astruct_sim_data_html"><div class="ttname"><a href="struct_sim_data.html">SimData</a></div><div class="ttdoc">Composite type that is used to run crossing simulations.</div><div class="ttdef"><b>Definition:</b> sim-operations.h:224</div></div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line">founders &lt;- load.data(allele.file=&quot;genotype-file.txt&quot;, map.file=&quot;map-file.txt&quot;)</div>
</div><!-- fragment --> </td></tr>
</table>
<p >Consider using the get_group_ family of functions (genomicSimulationC) and see.group.data function (genomicSimulation) to confirm data is correctly loaded.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Load a genetic map and several sets of founder genotypes</h2>
<table class="doxtable">
<tr>
<th>Task </th><th>Input Files </th><th>genomicSimulationC (C) </th><th>genomicSimulation (R) </th></tr>
<tr>
<td></td><td><p class="starttd">Genotype file/Allele file:</p><ul>
<li>File location: genotype-file.txt</li>
<li>File contents: <div class="fragment"><div class="line">name    G01 G02 G03 G04 G05</div>
<div class="line">m1  TT  TT  TT  TA  TT</div>
<div class="line">m3  TT  TT  TA  TA  TT</div>
<div class="line">m2  AA  AA  AA  AA  TT</div>
</div><!-- fragment --></li>
</ul>
<p class="intertd">Genotype file 2:</p><ul>
<li>File location: genotype-file2.txt</li>
<li>File contents: <div class="fragment"><div class="line">name    G06</div>
<div class="line">m1  AT</div>
<div class="line">m2  AA</div>
<div class="line">m3  TT</div>
</div><!-- fragment --></li>
</ul>
<p class="endtd">Map file:</p><ul>
<li>File location: map-file.txt</li>
<li>File contents: <div class="fragment"><div class="line">marker chr pos</div>
<div class="line">m3 3 15</div>
<div class="line">m2 1 8.3</div>
<div class="line">m1 1 5.2</div>
</div><!-- fragment --> </li>
</ul>
</td><td><div class="fragment"><div class="line"><a class="code hl_struct" href="struct_sim_data.html">SimData</a>* d = <a class="code hl_function" href="group__loaders.html#gaf7350bdc690b7cb5592892858d2830a9">create_empty_simdata</a>();</div>
<div class="line"><span class="keywordtype">int</span> founders_a = <a class="code hl_function" href="group__loaders.html#ga54cd625669413c2ef171060e9844d814">load_all_simdata</a>(d, <span class="stringliteral">&quot;genotype-file.txt&quot;</span>, <span class="stringliteral">&quot;map-file.txt&quot;</span>, NULL);</div>
<div class="line"><span class="keywordtype">int</span> founders_b = <a class="code hl_function" href="group__loaders.html#ga8bd85cb47ec8e0c4049f937ef40ae102">load_more_transposed_genes_to_simdata</a>(d, <span class="stringliteral">&quot;genotype-file2.txt&quot;</span>);</div>
<div class="ttc" id="agroup__loaders_html_ga8bd85cb47ec8e0c4049f937ef40ae102"><div class="ttname"><a href="group__loaders.html#ga8bd85cb47ec8e0c4049f937ef40ae102">load_more_transposed_genes_to_simdata</a></div><div class="ttdeci">int load_more_transposed_genes_to_simdata(SimData *d, const char *filename)</div><div class="ttdoc">Appends genotype data from a file to an existing SimData.</div><div class="ttdef"><b>Definition:</b> sim-operations.c:3293</div></div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line">founders_a &lt;- load.data(allele.file=&quot;genotype-file.txt&quot;, map.file=&quot;map-file.txt&quot;)</div>
<div class="line">founders_b &lt;- load.more.genotypes(&quot;genotype-file2.txt&quot;)</div>
</div><!-- fragment --> </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md9"></a>
Load a genetic map, a set of founder genotypes, and a set of additive trait effects</h2>
<table class="doxtable">
<tr>
<th>Task </th><th>Input Files </th><th>genomicSimulationC (C) </th><th>genomicSimulation (R) </th></tr>
<tr>
<td></td><td><p class="starttd">Genotype file/Allele file:</p><ul>
<li>File location: genotype-file.txt</li>
<li>File contents: <div class="fragment"><div class="line">name    G01 G02 G03 G04 G05 G06</div>
<div class="line">m1  TT  TT  TT  TA  TT  AT</div>
<div class="line">m3  TT  TT  TA  TA  TT  TT</div>
<div class="line">m2  AA  AA  AA  AA  TT  AA</div>
</div><!-- fragment --></li>
</ul>
<p class="intertd">Map file:</p><ul>
<li>File location: map-file.txt</li>
<li>File contents: <div class="fragment"><div class="line">marker chr pos</div>
<div class="line">m3 3 15</div>
<div class="line">m2 1 8.3</div>
<div class="line">m1 1 5.2</div>
</div><!-- fragment --></li>
</ul>
<p class="endtd">Effect file:</p><ul>
<li>File location: eff-file.txt</li>
<li>File contents: (line order does not matter) <div class="fragment"><div class="line">m1 A -0.8</div>
<div class="line">m2 A -0.1</div>
<div class="line">m3 A 0.1</div>
<div class="line">m1 T 0.9</div>
<div class="line">m3 T -0.1</div>
</div><!-- fragment --> </li>
</ul>
</td><td><div class="fragment"><div class="line"><a class="code hl_struct" href="struct_sim_data.html">SimData</a>* d = <a class="code hl_function" href="group__loaders.html#gaf7350bdc690b7cb5592892858d2830a9">create_empty_simdata</a>();</div>
<div class="line"><span class="keywordtype">int</span> founders = <a class="code hl_function" href="group__loaders.html#ga54cd625669413c2ef171060e9844d814">load_all_simdata</a>(d, <span class="stringliteral">&quot;genotype-file.txt&quot;</span>, <span class="stringliteral">&quot;map-file.txt&quot;</span>, <span class="stringliteral">&quot;eff-file.txt&quot;</span>);</div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line">founders &lt;- load.data(allele.file=&quot;genotype-file.txt&quot;, map.file=&quot;map-file.txt&quot;, effect.file=&quot;eff-file.txt&quot;)</div>
</div><!-- fragment --> </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md10"></a>
Swap out the set of additive trait effects for another</h2>
<p >This assumes the simulation is set up, that is, one of <b>Load a genetic map and a set of founder genotypes</b>, <b>Load a genetic map and several sets of founder genotypes</b>, <b>Load a genetic map, a set of founder genotypes, and a set of additive trait effects</b> or equivalent has been carried out. If the simulation is not yet set up and you with to load trait effect values, see the section above, titled <b>Load a genetic map, a set of founder genotypes, and a set of additive trait effects</b>.</p>
<table class="doxtable">
<tr>
<th>Task </th><th>Input Files </th><th>genomicSimulationC (C) </th><th>genomicSimulation (R) </th></tr>
<tr>
<td></td><td>Effect file:<ul>
<li>File location: eff-file2.txt </li>
</ul>
</td><td><div class="fragment"><div class="line"><a class="code hl_function" href="group__loaders.html#ga9d6b231bd6ddde82af66a5d276a2c739">load_effects_to_simdata</a>(d, <span class="stringliteral">&quot;eff-file2.txt&quot;</span>);</div>
<div class="ttc" id="agroup__loaders_html_ga9d6b231bd6ddde82af66a5d276a2c739"><div class="ttname"><a href="group__loaders.html#ga9d6b231bd6ddde82af66a5d276a2c739">load_effects_to_simdata</a></div><div class="ttdeci">void load_effects_to_simdata(SimData *d, const char *filename)</div><div class="ttdoc">Populates a SimData combination with effect values.</div><div class="ttdef"><b>Definition:</b> sim-operations.c:3699</div></div>
</div><!-- fragment --> </td><td><div class="fragment"><div class="line">load.different.effects(&quot;eff-file2.txt&quot;)</div>
</div><!-- fragment --> </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md11"></a>
Input file formats:</h2>
<p >The file format expected for the genotype file is something like: </p><div class="fragment"><div class="line">name    G01 G02 G03 G04 G05 G06</div>
<div class="line">m1  TT  TT  TT  TA  TT  AT</div>
<div class="line">m3  TT  TT  TA  TA  TT  TT</div>
<div class="line">m2  AA  AA  AA  AA  TT  AA</div>
</div><!-- fragment --><p> where G01, G02, ..., are names of the starter set of genotypes; m1, m2, ..., are the markers; and entries in the matrix are two-character pairs listing the two alleles that genotype has at that marker. Alleles can be any non-space character and the order of the two alleles is saved.</p>
<p >Cells may be space-separated or tab-separated. The order of rows and columns does not matter. The value in the first cell ("name" in this example) is ignored.</p>
<p >The C version of the package has additional functions for loading differently-formatted genotype files. This functionality is on track to be improved and shared between versions in some upcoming update.</p>
<p >The map file should be formatted as follows: </p><div class="fragment"><div class="line">marker chr pos</div>
<div class="line">m3 3 15</div>
<div class="line">m2 1 8.3</div>
<div class="line">m1 1 5.2</div>
</div><!-- fragment --><p >The first (header) line's values are not checked. After that, all rows must have three space-or-tab-separated values. The first should be the marker name, the second an integer representing the chromosome number, and the third a decimal representing the position of the SNP along the chromosome in centiMorgans (cM). The order of the rows in the file does not matter.</p>
<p >Only markers that appear both in the genotype file and the map file are used in simulation. The simulation tool will print as output the number of markers that were loaded and the number that were discarded.</p>
<p >Loading an effect file is optional for running the simulation. Its format should be: </p><div class="fragment"><div class="line">m1 A -0.8</div>
<div class="line">m2 A -0.1</div>
<div class="line">m3 A 0.1</div>
<div class="line">m1 T 0.9</div>
<div class="line">m3 T -0.1</div>
</div><!-- fragment --><p >The first column should be a marker name, corresponding to a name used in the map and genotype files. The second should be the allele (non-space character, eg A) this effect value corresponds to. The third should be a decimal representing the additive effect value of that allele for that marker.</p>
<p >A particular marker/allele combination not being included in the file is equivalent to that combination having an effect value of 0. If a particular marker/allele combination is included multiple times in a file, only the last occurence is saved. If a marker name in the file does not match any marker tracked by the simulation, that row will be ignored. The simulation will print out the number of marker/allele pairs for which effects are loaded: for the sample file above, that would be 5.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
Loading from other file formats</h3>
<p >Updates to expand the range of allowed input formats are coming soon.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Crossing &amp; Other Ways to Generate New Genotypes: Plant-themed</h1>
<p >Templates in this section assume you have loaded a set of founders whose group id is saved in the variable <code>founders</code>.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Single seed descent</h2>
<h2><a class="anchor" id="autotoc_md15"></a>
Creating halfsib or fullsib families</h2>
<h2><a class="anchor" id="autotoc_md16"></a>
Updating marker effects</h2>
<h2><a class="anchor" id="autotoc_md17"></a>
Trials and locations</h2>
<h2><a class="anchor" id="autotoc_md18"></a>
Backcrossing</h2>
<h1><a class="anchor" id="autotoc_md19"></a>
Crossing &amp; Other Ways to Generate New Genotypes: Animal-themed</h1>
<h2><a class="anchor" id="autotoc_md20"></a>
Split offspring into male and female</h2>
<h2><a class="anchor" id="autotoc_md21"></a>
Introducing fresh blood to separate male and female kernels</h2>
<h2><a class="anchor" id="autotoc_md22"></a>
Random mating with caps on number of offspring per animal</h2>
<h2><a class="anchor" id="autotoc_md23"></a>
Mating all females to a good male</h2>
<h2><a class="anchor" id="autotoc_md24"></a>
Making specific chosen matings</h2>
<h2><a class="anchor" id="autotoc_md25"></a>
Tracking age and discarding individuals that are 'too old'</h2>
<p >Updates to add an age/custom flag to each individual is coming soon.</p>
<h1><a class="anchor" id="autotoc_md26"></a>
Selection</h1>
<h2><a class="anchor" id="autotoc_md27"></a>
Manually select on true breeding value</h2>
<p >The template selection template. This does the exact same thing as split_by_bv / select.by.gebv, but using the 'custom selection method interface'. Hopefully this aids in understanding the concept.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Select on phenotype (simulated with a given heritability)</h2>
<h2><a class="anchor" id="autotoc_md29"></a>
Select on a qualitative trait</h2>
<h2><a class="anchor" id="autotoc_md30"></a>
Select on a qualitative trait, then a quantitative trait.</h2>
<h2><a class="anchor" id="autotoc_md31"></a>
Select on an index weighting two traits.</h2>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
